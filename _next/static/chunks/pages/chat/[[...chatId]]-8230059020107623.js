(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{5839:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[[...chatId]]",function(){return n(4087)}])},4087:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var a=n(5893),c=n(1664),r=n.n(c),s=n(7294);let i=()=>(0,a.jsx)("div",{className:"bg-gray-900 text-white",children:(0,a.jsx)(r(),{href:"/api/auth/logout",children:"Logout"})});var l=n(9008),o=n.n(l);function d(){let[e,t]=(0,s.useState)(""),[n,c]=(0,s.useState)([]),r=async t=>{t.preventDefault();try{let t=(await fetch("/api/chat/sendMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})})).data;if(!t)return;let n=t.getReader();await function(e,t){var n,a,c,r;return n=this,a=void 0,c=void 0,r=function*(){let n=new TextDecoder,a=!1,c="";for(;!a;){let{value:r,done:s}=yield e.read();for(let e of(a=s,n.decode(r).split("\n")))if(e){c&&(e=c+e,c="");let n=e.match(/\{(.*?)\}/);n&&(c=e.replace(n[0],""),e=n[0]);try{let n=JSON.parse(e);t({event:n.e||"event",content:decodeURI(n.c)})}catch(t){c=e}}}},new(c||(c=Promise))(function(e,t){function s(e){try{l(r.next(e))}catch(e){t(e)}}function i(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof c?n:new c(function(e){e(n)})).then(s,i)}l((r=r.apply(n,a||[])).next())})}(n,e=>{console.log("MESSAGE",e)})}catch(e){console.error(e)}};return(0,a.jsxs)("div",{children:[(0,a.jsx)(o(),{children:(0,a.jsx)("title",{children:"new chat"})}),(0,a.jsxs)("div",{className:"grid h-screen grid-cols-[260px_1fr]",children:[(0,a.jsx)(i,{}),(0,a.jsxs)("div",{className:"bg-gray-700 flex flex-col",children:[(0,a.jsx)("div",{className:"flex-1",children:n&&n.map((e,t)=>(0,a.jsx)("p",{children:e},t))}),(0,a.jsx)("footer",{className:"bg-gray-800 p-10 ",children:(0,a.jsx)("form",{onSubmit:r,children:(0,a.jsxs)("fieldset",{className:"flex gap-2",children:[(0,a.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"Send a meassage",className:"w-full resize-none rounded-md bg-gray-700 p-2 text-white focus:border-emerald-500 focus:bg-gray-600 focus:outline focus:outline-emerald-600"}),(0,a.jsx)("button",{className:"btn",type:"submit",children:"Send"})]})})})]})]})]})}}},function(e){e.O(0,[996,888,774,179],function(){return e(e.s=5839)}),_N_E=e.O()}]);